{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nlet currentPage = 1;\nlet totalHits = 0;\n\nexport async function getImage(imageTitle) {\n    const baseUrl = 'https://pixabay.com/api/';\n    const API_KEY = '48985063-5c5813c169e3db6e477352dc5';\n    \n    const response = await axios.get(baseUrl, {\n        params: {\n            key: API_KEY,\n            q: imageTitle,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: 'true',\n            page: currentPage,\n            per_page: 40,\n        },\n    });\n\n    currentPage++;\n    return response;\n}\n\nexport function resetPage() {\n    currentPage = 1;\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst gallery = document.querySelector('.gallery');\nconst loading = document.querySelector('.loader-div');\nconst endLoading = document.querySelector('.end-loader-div');\n\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionData: 'alt',\n  captionDelay: 250,\n});\n\n\nexport function createImgCard(image) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = image;\n  \n  return `\n    <div class=\"image-card\">\n      <a href=\"${largeImageURL}\" target=\"_blank\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n      </a>\n      <div class=\"info\">\n        <p><strong>Likes:</strong>${likes}</p>\n        <p><strong>Views:</strong>${views}</p>\n        <p><strong>Comments:</strong>${comments}</p>\n        <p><strong>Downloads:</strong>${downloads}</p>\n      </div>\n    </div>\n  `;\n\n}\n\n\nexport function renderGallery(images) {\n  gallery.innerHTML += images.map(createImgCard).join('');\n  lightbox.refresh();\n  hideLoader();\n}\n\nexport function showLoader() {\n  console.log('Done showLoader()');\n  gallery.classList.add('hidden');\n  loading.classList.remove('hidden');\n}\n\nexport function showEndLoader() {\n  console.log('Done showEndLoader()');\n  gallery.classList.add('hidden');\n  endLoading.classList.remove('hidden');\n}\n\n\nexport function hideLoader() {\n  console.log('Done hideLoader()');\n  loading.classList.add('hidden');\n  gallery.classList.remove('hidden');\n}\n\nexport function hideEndLoader() {\n  console.log('Done hideEndLoader()');\n  endLoading.classList.add('hidden');\n  gallery.classList.remove('hidden');\n}\n\nexport function showMessage() {\n  iziToast.show({\n    position: 'topRight',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    messageColor: '#fff',\n    maxWidth: '432px',\n    backgroundColor: '#EF4040',\n  });\n}\n\nexport function showEndMessage() {\n  iziToast.show({\n    position: 'topRight',\n    message:\n      \"We're sorry, but you've reached the end of search results.\",\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    messageColor: '#fff',\n    maxWidth: '432px',\n    backgroundColor: '#EF4040',\n  });\n}\n\n","import { getImage, resetPage } from './js/pixabay-api.js';\nimport {\n    hideLoader,\n    renderGallery,\n    createImgCard,\n    showLoader,\n    showMessage,\n    showEndMessage,\n} from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.search-input');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst gallery = document.querySelector('.gallery');\nconst endLoaderDiv = document.querySelector('.end-loader-div');\nlet searchQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\nlet cardHeight = 0;\n\nform.addEventListener('submit', funSubmit);\nloadMoreBtn.addEventListener('click', loadMoreImages);\n \nasync function funSubmit(e) {\n    e.preventDefault();\n\n\n  const newSearchText = input.value.trim();\n  if (!newSearchText) return showMessage();\n\n  searchQuery = newSearchText;\n  resetPage();\n  input.value = '';\n  showLoader();\n  clearGallery();\n\n  getImage(searchQuery)\n    .then(data => {\n        const images = data.data.hits;\n        totalHits = data.data.totalHits;\n\n        console.log('Total hits:', totalHits);\n\n        if (!images || images.length === 0) {\n            showMessage();\n            loadMoreBtn.classList.add('hidden');\n            endLoaderDiv.classList.add('hidden');\n      } else {\n          renderGallery(images);\n          toggleLoadMoreButton(images.length);\n          scrollPage();\n      }\n    })\n    .catch(err => {\n      console.error('Error during image search', err);\n      hideLoader();\n      showMessage();\n    });\n}\n\nasync function loadMoreImages() {\n    // showLoader();\n    endLoaderDiv.classList.remove('hidden');\n\n  getImage(searchQuery)\n    .then(data => {\n        const images = data.data.hits;\n        totalHits = data.data.totalHits;\n\n        console.log('Total hits:', totalHits);\n\n      if (!images || images.length === 0) {\n        // hideLoader();\n        endLoaderDiv.classList.add('hidden');\n        loadMoreBtn.classList.add('hidden');\n        return;\n      }\n\n      renderGallery(images); \n        toggleLoadMoreButton(images.length); \n        scrollPage();\n        currentPage += 1;\n    })\n    .catch(err => {\n      console.error('Error during image load more', err);\n      hideLoader();\n      showMessage();\n    });\n}\n\nfunction toggleLoadMoreButton(imageCount) {\n  const totalLoadedImages = gallery.querySelectorAll('.image-card').length;\n\n  if (totalLoadedImages >= totalHits) {\n    loadMoreBtn.classList.add('hidden');\n    endLoaderDiv.classList.add('hidden');\n    showEndMessage();\n  } else {\n    loadMoreBtn.classList.remove('hidden');\n    endLoaderDiv.classList.add('hidden');\n  }\n}\n\nfunction clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  gallery.innerHTML = '';\n  hideLoader();\n}\n\nfunction scrollPage() {\n  const firstImageCard = gallery.querySelector('.image-card');\n  if (firstImageCard && !cardHeight) {\n    cardHeight = firstImageCard.getBoundingClientRect().height;\n  }\n\n  if (cardHeight) {\n    window.scrollBy({\n      top: cardHeight * 2, \n      behavior: 'smooth',\n    });\n  }\n}"],"names":["currentPage","getImage","imageTitle","response","axios","resetPage","gallery","loading","lightbox","SimpleLightbox","createImgCard","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","images","hideLoader","showLoader","showMessage","iziToast","showEndMessage","form","input","loadMoreBtn","endLoaderDiv","searchQuery","totalHits","cardHeight","funSubmit","loadMoreImages","newSearchText","clearGallery","data","toggleLoadMoreButton","scrollPage","err","imageCount","firstImageCard"],"mappings":"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"}